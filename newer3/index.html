<!doctype html>
<html lang="en" class="dukr3g-theme-light">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Dukr3g Reader • M2 Namespaced</title>
  <link rel="stylesheet" href="reader.css">
</head>
<body>
  <!-- Single opener: 讀 -->
  <button id="dukr3g-open"
          class="dukr3g-open"
          aria-haspopup="dialog"
          aria-controls="dukr3g-dialog"
          aria-expanded="false"
          aria-label="Open reader tools (Alt+R)"
          title="Reader tools (Alt+R)">
    <span class="dukr3g-glyph" aria-hidden="true">讀</span>
  </button>

  <!-- One dialog with 3 views: Menu, Display, TTS -->
  <dialog id="dukr3g-dialog" aria-labelledby="dukr3g-h-menu">
    <form method="dialog" class="dukr3g-panel" novalidate>
      <header class="dukr3g-panel-head">
        <h2 id="dukr3g-dialog-title">Reader Tools</h2>
        <div class="dukr3g-head-actions">
          <button id="dukr3g-btn-back"  type="button" aria-label="Back">←</button>
          <button id="dukr3g-btn-close" type="button" aria-label="Close">×</button>
        </div>
      </header>

      <!-- View: Menu -->
      <section id="dukr3g-view-menu" class="dukr3g-panel-body dukr3g-view dukr3g-current"
               role="document" aria-describedby="dukr3g-menu-help">
        <p id="dukr3g-menu-help" class="dukr3g-visually-hidden">Choose a tool category.</p>
        <ul class="dukr3g-tile-grid" role="list">
          <li>
            <button type="button" id="dukr3g-go-display" class="dukr3g-tile" aria-describedby="dukr3g-desc-display">
              <span class="dukr3g-tile-title">Display</span>
              <span id="dukr3g-desc-display" class="dukr3g-tile-desc">Theme, size, measure, line height</span>
            </button>
          </li>
          <li>
            <button type="button" id="dukr3g-go-tts" class="dukr3g-tile" aria-describedby="dukr3g-desc-tts">
              <span class="dukr3g-tile-title">TTS</span>
              <span id="dukr3g-desc-tts" class="dukr3g-tile-desc">Play, rate, pitch, voice</span>
            </button>
          </li>
        </ul>
        <div class="dukr3g-kbd-help">Tips: press D for Display, T for TTS, Esc to close.</div>
      </section>

      <!-- View: Display -->
      <section id="dukr3g-view-display" class="dukr3g-panel-body dukr3g-view"
               role="document" aria-labelledby="dukr3g-h-display" hidden>
        <h3 id="dukr3g-h-display" class="dukr3g-view-heading">Display</h3>

        <fieldset>
          <legend>Theme</legend>
          <label for="dukr3g-theme" class="dukr3g-visually-hidden">Theme</label>
          <select id="dukr3g-theme" aria-label="Theme">
            <option value="dukr3g-theme-light">Light</option>
            <option value="dukr3g-theme-dark">Dark</option>
            <option value="dukr3g-theme-sepia">Sepia</option>
            <option value="dukr3g-theme-gray">Gray</option>
            <option value="dukr3g-theme-high-contrast">High contrast</option>
            <option value="dukr3g-theme-custom">Custom</option>
          </select>
        </fieldset>

        <fieldset id="dukr3g-custom-colors" hidden>
          <legend>Custom colors</legend>

          <!-- Text -->
          <div class="dukr3g-control">
            <label for="dukr3g-user-text-hex">Text</label>
            <input id="dukr3g-user-text-hex" type="text" inputmode="text"
                   pattern="^#([0-9a-fA-F]{6}|[0-9a-fA-F]{3})$"
                   value="#111111" aria-label="Custom text color hex"
                   autocomplete="off" spellcheck="false" placeholder="#RRGGBB">
            <input id="dukr3g-user-text" type="color" value="#111111" aria-label="Custom text color window">
            <output for="dukr3g-user-text-hex">#111111</output>
          </div>

          <!-- Background -->
          <div class="dukr3g-control">
            <label for="dukr3g-user-bg-hex">Background</label>
            <input id="dukr3g-user-bg-hex" type="text" inputmode="text"
                   pattern="^#([0-9a-fA-F]{6}|[0-9a-fA-F]{3})$"
                   value="#ffffff" aria-label="Custom background color hex"
                   autocomplete="off" spellcheck="false" placeholder="#RRGGBB">
            <input id="dukr3g-user-bg" type="color" value="#ffffff" aria-label="Custom background color window">
            <output for="dukr3g-user-bg-hex">#ffffff</output>
          </div>

          <!-- Unvisited link -->
          <div class="dukr3g-control">
            <label for="dukr3g-user-link-hex">Unvisited link</label>
            <input id="dukr3g-user-link-hex" type="text" inputmode="text"
                   pattern="^#([0-9a-fA-F]{6}|[0-9a-fA-F]{3})$"
                   value="#2b6cf0" aria-label="Custom unvisited link color hex"
                   autocomplete="off" spellcheck="false" placeholder="#RRGGBB">
            <input id="dukr3g-user-link" type="color" value="#2b6cf0" aria-label="Custom unvisited link color window">
            <output for="dukr3g-user-link-hex">#2b6cf0</output>
          </div>

          <!-- Visited link -->
          <div class="dukr3g-control">
            <label for="dukr3g-user-visited-hex">Visited link</label>
            <input id="dukr3g-user-visited-hex" type="text" inputmode="text"
                   pattern="^#([0-9a-fA-F]{6}|[0-9a-fA-F]{3})$"
                   value="#5a2bb0" aria-label="Custom visited link color hex"
                   autocomplete="off" spellcheck="false" placeholder="#RRGGBB">
            <input id="dukr3g-user-visited" type="color" value="#5a2bb0" aria-label="Custom visited link color window">
            <output for="dukr3g-user-visited-hex">#5a2bb0</output>
          </div>

          <!-- Read aloud ink -->
          <div class="dukr3g-control">
            <label for="dukr3g-ral-ink-hex">Read aloud ink</label>
            <input id="dukr3g-ral-ink-hex" type="text" inputmode="text"
                   pattern="^#([0-9a-fA-F]{6}|[0-9a-fA-F]{3})$"
                   value="#0064ff" aria-label="Read aloud ink color hex"
                   autocomplete="off" spellcheck="false" placeholder="#RRGGBB">
            <input id="dukr3g-ral-ink" type="color" value="#0064ff" aria-label="Read aloud ink color window">
            <output for="dukr3g-ral-ink-hex">#0064ff</output>
          </div>

          <!-- Read aloud background -->
          <div class="dukr3g-control">
            <label for="dukr3g-ral-bg-hex">Read aloud background</label>
            <input id="dukr3g-ral-bg-hex" type="text" inputmode="text"
                   pattern="^#([0-9a-fA-F]{6}|[0-9a-fA-F]{3})$"
                   value="#ffec80" aria-label="Read aloud background color hex"
                   autocomplete="off" spellcheck="false" placeholder="#RRGGBB">
            <input id="dukr3g-ral-bg" type="color" value="#ffec80" aria-label="Read aloud background color window">
            <output for="dukr3g-ral-bg-hex">#ffec80</output>
          </div>
        </fieldset>

        <fieldset>
          <legend>Text geometry</legend>

          <!-- Font size -->
          <div class="dukr3g-control">
            <label for="dukr3g-size">Font size</label>
            <input id="dukr3g-size-num" type="number" inputmode="decimal"
                   min="0.30" max="3.00" step="0.01" value="1.00" aria-label="Font size value">
            <input id="dukr3g-size" type="range"
                   min="0.30" max="3.00" step="0.01" value="1.00">
            <output id="dukr3g-size-out" for="dukr3g-size">1.00</output>
          </div>

          <!-- Measure -->
          <div class="dukr3g-control">
            <label for="dukr3g-measure">Measure (ch)</label>
            <input id="dukr3g-measure-num" type="number" inputmode="numeric"
                   min="40" max="121" step="1" value="70" aria-label="Measure value">
            <input id="dukr3g-measure" type="range"
                   min="40" max="121" step="1" value="70">
            <output id="dukr3g-measure-out" for="dukr3g-measure">70</output>
          </div>

          <!-- Line height -->
          <div class="dukr3g-control">
            <label for="dukr3g-leading">Line height</label>
            <input id="dukr3g-leading-num" type="number" inputmode="decimal"
                   min="1.00" max="2.50" step="0.01" value="1.60" aria-label="Line height value">
            <input id="dukr3g-leading" type="range"
                   min="1.00" max="2.50" step="0.01" value="1.60">
            <output id="dukr3g-leading-out" for="dukr3g-leading">1.60</output>
          </div>
        </fieldset>
      </section>

      <!-- View: TTS -->
      <section id="dukr3g-view-tts" class="dukr3g-panel-body dukr3g-view"
               role="document" aria-labelledby="dukr3g-h-tts" hidden>
        <h3 id="dukr3g-h-tts" class="dukr3g-view-heading">Text to Speech</h3>

        <div class="dukr3g-row dukr3g-tts-playback" role="group" aria-label="Playback">
          <button type="button" id="dukr3g-tts-play"  title="Play">▶</button>
          <button type="button" id="dukr3g-tts-pause" title="Pause">⏸</button>
          <button type="button" id="dukr3g-tts-stop"  title="Stop">⏹</button>
        </div>

        <!-- Rate -->
        <div class="dukr3g-control">
          <label for="dukr3g-tts-rate">Rate</label>
          <input id="dukr3g-tts-rate-num" type="number" inputmode="decimal"
                 min="0.10" max="10.00" step="0.05" value="1.00" aria-label="Speech rate value">
          <input id="dukr3g-tts-rate" type="range"
                 min="0.10" max="10.00" step="0.05" value="1.00">
          <output id="dukr3g-tts-rate-out" for="dukr3g-tts-rate">1.00x</output>
        </div>

        <!-- Pitch -->
        <div class="dukr3g-control">
          <label for="dukr3g-tts-pitch">Pitch</label>
          <input id="dukr3g-tts-pitch-num" type="number" inputmode="decimal"
                 min="0.10" max="5.00" step="0.05" value="1.00" aria-label="Speech pitch value">
          <input id="dukr3g-tts-pitch" type="range"
                 min="0.10" max="5.00" step="0.05" value="1.00">
          <output id="dukr3g-tts-pitch-out" for="dukr3g-tts-pitch">1.00</output>
        </div>

        <div class="dukr3g-control">
          <label for="dukr3g-tts-voice">Voice</label>
          <select id="dukr3g-tts-voice" aria-label="Voice"></select>
        </div>

        <p class="dukr3g-note">This basic TTS uses the browser speech engine if available. It reads the first article on the page.</p>
      </section>
    </form>
  </dialog>

  <!-- Live announcements -->
  <div id="dukr3g-status" role="status" aria-live="polite" class="dukr3g-status"></div>

  <!-- Reading content: only this block uses dukr3g typography vars -->
  <main id="main">
    <article class="dukr3g-prose" aria-labelledby="t1">
      <h1 id="t1">Test Article</h1>
      <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Etiam nec purus a dui placerat fermentum.</p>
      <p>Use Display to adjust theme, size, measure, and line height.</p>
    </article>
  </main>

  <script src="reader.js" defer></script>
</body>
</html>
